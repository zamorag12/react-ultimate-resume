{"ast":null,"code":"import _objectSpread from\"/home/gzamora/Documents/test/react-ultimate-resume/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/gzamora/Documents/test/react-ultimate-resume/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useCallback,useContext,useMemo,useState}from'react';import{createUseStyles,useTheme}from'react-jss';import{useFormikContext}from'formik';import keyBy from'lodash/keyBy';import capitalize from'lodash/capitalize';import omit from'lodash/omit';import uuid from'uuid/v4';import{arrayMove}from'react-sortable-hoc';import useMediaQuery from'@material-ui/core/useMediaQuery/useMediaQuery';import{Typography}from'@welovedevs/ui';import{SearchGifsDialog}from'../../../../../commons/search_gif_dialog/search_gifs_dialog';import{AddButtonDashed}from'../../../../../commons/add_button_dashed/add_button_dashed';import{GifsSortableCards}from'./gifs_sortable_cards/gifs_sortable_cards';import{styles}from'./gifs_edit_form_styles';import{StaticDataContext}from'../../../../../../utils/context/contexts';import{URLFallbackDialog}from'../../../../../commons/url_fallback_dialog.jsx/url_fallback_dialog';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var useStyles=createUseStyles(styles);var GifsEditFormComponent=function GifsEditFormComponent(_ref){var handleValueChange=_ref.helpers.handleValueChange;var theme=useTheme();var isMobile=useMediaQuery(\"(max-width: \".concat(theme.screenSizes.small,\"px)\"));var classes=useStyles();var _useFormikContext=useFormikContext(),interests=_useFormikContext.values.interests,validationErrors=_useFormikContext.errors;var _useContext=useContext(StaticDataContext),apiKeys=_useContext.apiKeys;var hasGiphyKey=useMemo(function(){return!!apiKeys.giphy;},[apiKeys.giphy]);var _useState=useState(null),_useState2=_slicedToArray(_useState,2),selectedIndex=_useState2[0],setSelectedIndex=_useState2[1];var removeSelectedIndex=useCallback(function(){return setSelectedIndex(null);},[]);var _ref2=validationErrors||{},errors=_ref2.interests;var keyedValues=useMemo(function(){return keyBy(interests,function(_ref3){var id=_ref3.id;return id;});},[JSON.stringify(interests)]);var interestChanged=useCallback(function(interestIndex,field,value){handleValueChange(\"interests[\".concat(interestIndex,\"].\").concat(field))(value);},[]);var interestDeleted=useCallback(function(id){handleValueChange('interests')(Object.values(omit(keyedValues,id)));},[JSON.stringify(keyedValues),JSON.stringify(interests)]);var addInterest=useCallback(function(){var id=uuid();handleValueChange('interests')(interests.concat({index:interests.length,id:id}));setSelectedIndex(interests.length);},[JSON.stringify(interests)]);var move=useCallback(function(_ref4){var oldIndex=_ref4.oldIndex,newIndex=_ref4.newIndex;handleValueChange('interests')(arrayMove(interests,oldIndex,newIndex).map(function(data,index){return _objectSpread(_objectSpread({},data),{},{index:index});}));},[interests]);var globalError=typeof errors==='string'&&errors;var handleGifSelection=useCallback(function(_ref5){var url=_ref5.url,title=_ref5.title,user=_ref5.user;interestChanged(selectedIndex,'name',capitalize(title));interestChanged(selectedIndex,'gifUrl',url);interestChanged(selectedIndex,'gifUser',user);removeSelectedIndex();},[interestChanged,selectedIndex]);var handleGifChange=useCallback(function(url){interestChanged(selectedIndex,'gifUrl',url);},[interestChanged,selectedIndex]);return/*#__PURE__*/_jsxs(_Fragment,{children:[hasGiphyKey&&/*#__PURE__*/_jsx(SearchGifsDialog,{open:Boolean(selectedIndex!==null),onClose:removeSelectedIndex,onSelect:handleGifSelection}),!hasGiphyKey&&/*#__PURE__*/_jsx(URLFallbackDialog,{open:Boolean(selectedIndex!==null),onClose:removeSelectedIndex,onChange:handleGifChange}),globalError&&/*#__PURE__*/_jsx(Typography,{color:\"danger\",variant:\"h4\",component:\"h4\",children:globalError}),isMobile&&/*#__PURE__*/_jsx(AddButtonDashed,{classes:{container:classes.addButtonDashed},onClick:addInterest}),/*#__PURE__*/_jsx(GifsSortableCards,{items:interests,interestDeleted:interestDeleted,interestChanged:interestChanged,errors:errors,onSortEnd:move,setSelectedIndex:setSelectedIndex}),!isMobile&&/*#__PURE__*/_jsx(AddButtonDashed,{classes:{container:classes.addButtonDashed},onClick:addInterest})]});};export var GifsEditForm=GifsEditFormComponent;","map":{"version":3,"sources":["/home/gzamora/Documents/test/react-ultimate-resume/src/package/components/cards/cards_types/gifs/gifs_edit_dialog/gifs_edit_form/gifs_edit_form.jsx"],"names":["React","useCallback","useContext","useMemo","useState","createUseStyles","useTheme","useFormikContext","keyBy","capitalize","omit","uuid","arrayMove","useMediaQuery","Typography","SearchGifsDialog","AddButtonDashed","GifsSortableCards","styles","StaticDataContext","URLFallbackDialog","useStyles","GifsEditFormComponent","handleValueChange","helpers","theme","isMobile","screenSizes","small","classes","interests","values","validationErrors","errors","apiKeys","hasGiphyKey","giphy","selectedIndex","setSelectedIndex","removeSelectedIndex","keyedValues","id","JSON","stringify","interestChanged","interestIndex","field","value","interestDeleted","Object","addInterest","concat","index","length","move","oldIndex","newIndex","map","data","globalError","handleGifSelection","url","title","user","handleGifChange","Boolean","container","addButtonDashed","GifsEditForm"],"mappings":"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","sourcesContent":["import React, { useCallback, useContext, useMemo, useState } from 'react';\n\nimport { createUseStyles, useTheme } from 'react-jss';\nimport { useFormikContext } from 'formik';\nimport keyBy from 'lodash/keyBy';\nimport capitalize from 'lodash/capitalize';\n\nimport omit from 'lodash/omit';\nimport uuid from 'uuid/v4';\nimport { arrayMove } from 'react-sortable-hoc';\n\nimport useMediaQuery from '@material-ui/core/useMediaQuery/useMediaQuery';\nimport { Typography } from '@welovedevs/ui';\n\nimport { SearchGifsDialog } from '../../../../../commons/search_gif_dialog/search_gifs_dialog';\nimport { AddButtonDashed } from '../../../../../commons/add_button_dashed/add_button_dashed';\nimport { GifsSortableCards } from './gifs_sortable_cards/gifs_sortable_cards';\n\nimport { styles } from './gifs_edit_form_styles';\nimport { StaticDataContext } from '../../../../../../utils/context/contexts';\nimport { URLFallbackDialog } from '../../../../../commons/url_fallback_dialog.jsx/url_fallback_dialog';\n\nconst useStyles = createUseStyles(styles);\n\nconst GifsEditFormComponent = ({ helpers: { handleValueChange } }) => {\n    const theme = useTheme();\n    const isMobile = useMediaQuery(`(max-width: ${theme.screenSizes.small}px)`);\n    const classes = useStyles();\n    const {\n        values: { interests },\n        errors: validationErrors\n    } = useFormikContext();\n\n    const { apiKeys } = useContext(StaticDataContext);\n    const hasGiphyKey = useMemo(() => !!apiKeys.giphy, [apiKeys.giphy]);\n\n    const [selectedIndex, setSelectedIndex] = useState(null);\n    const removeSelectedIndex = useCallback(() => setSelectedIndex(null), []);\n\n    const { interests: errors } = validationErrors || {};\n\n    const keyedValues = useMemo(() => keyBy(interests, ({ id }) => id), [JSON.stringify(interests)]);\n\n    const interestChanged = useCallback((interestIndex, field, value) => {\n        handleValueChange(`interests[${interestIndex}].${field}`)(value);\n    }, []);\n\n    const interestDeleted = useCallback(\n        (id) => {\n            handleValueChange('interests')(Object.values(omit(keyedValues, id)));\n        },\n        [JSON.stringify(keyedValues), JSON.stringify(interests)]\n    );\n\n    const addInterest = useCallback(() => {\n        const id = uuid();\n        handleValueChange('interests')(\n            interests.concat({\n                index: interests.length,\n                id\n            })\n        );\n\n        setSelectedIndex(interests.length);\n    }, [JSON.stringify(interests)]);\n\n    const move = useCallback(\n        ({ oldIndex, newIndex }) => {\n            handleValueChange('interests')(\n                arrayMove(interests, oldIndex, newIndex).map((data, index) => ({ ...data, index }))\n            );\n        },\n        [interests]\n    );\n\n    const globalError = typeof errors === 'string' && errors;\n\n    const handleGifSelection = useCallback(\n        ({ url, title, user }) => {\n            interestChanged(selectedIndex, 'name', capitalize(title));\n            interestChanged(selectedIndex, 'gifUrl', url);\n            interestChanged(selectedIndex, 'gifUser', user);\n            removeSelectedIndex();\n        },\n        [interestChanged, selectedIndex]\n    );\n    const handleGifChange = useCallback(\n        (url) => {\n            interestChanged(selectedIndex, 'gifUrl', url);\n        },\n        [interestChanged, selectedIndex]\n    );\n\n    return (\n        <>\n            {hasGiphyKey && (\n                <SearchGifsDialog\n                    open={Boolean(selectedIndex !== null)}\n                    onClose={removeSelectedIndex}\n                    onSelect={handleGifSelection}\n                />\n            )}\n            {!hasGiphyKey && (\n                <URLFallbackDialog\n                    open={Boolean(selectedIndex !== null)}\n                    onClose={removeSelectedIndex}\n                    onChange={handleGifChange}\n                />\n            )}\n            {globalError && (\n                <Typography color=\"danger\" variant=\"h4\" component=\"h4\">\n                    {globalError}\n                </Typography>\n            )}\n            {isMobile && (\n                <AddButtonDashed\n                    classes={{\n                        container: classes.addButtonDashed\n                    }}\n                    onClick={addInterest}\n                />\n            )}\n            <GifsSortableCards\n                items={interests}\n                interestDeleted={interestDeleted}\n                interestChanged={interestChanged}\n                errors={errors}\n                onSortEnd={move}\n                setSelectedIndex={setSelectedIndex}\n            />\n            {!isMobile && (\n                <AddButtonDashed\n                    classes={{\n                        container: classes.addButtonDashed\n                    }}\n                    onClick={addInterest}\n                />\n            )}\n        </>\n    );\n};\n\nexport const GifsEditForm = GifsEditFormComponent;\n"]},"metadata":{},"sourceType":"module"}